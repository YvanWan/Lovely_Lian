<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ç»™æœ€å¯çˆ±çš„è²è² ğŸ’–</title>
  <style>
    :root{
      --bg: #fff7fb;
      --pink: #ff8fab;
      --hot: #ff477e;
      --lav: #a78bfa;
      --card: #ffffff;
      --text: #222;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft Yahei", Arial, sans-serif;
      background: radial-gradient(1200px 1200px at 20% 0%, #ffe0f0 0%, var(--bg) 35%),
                  radial-gradient(1000px 800px at 80% 100%, #efe9ff 0%, var(--bg) 40%);
      color:var(--text);
      overflow-x:hidden;
    }
    /* é£˜åŠ¨å°å¿ƒå¿ƒèƒŒæ™¯ */
    .hearts{position:fixed; inset:0; pointer-events:none; z-index:0; overflow:hidden}
    .heart{position:absolute; width:14px; height:14px; transform:rotate(45deg); opacity:.6; animation:float 10s linear infinite}
    .heart:before,.heart:after{content:""; position:absolute; width:14px; height:14px; background:currentColor; border-radius:50%}
    .heart:before{left:-7px}
    .heart:after{top:-7px}
    @keyframes float{0%{transform:translateY(110vh) rotate(45deg)}100%{transform:translateY(-10vh) rotate(45deg)}}

    /* å¸ƒå±€ */
    .wrap{position:relative; z-index:1; padding:32px; max-width:980px; margin:0 auto}
    .title{display:flex; align-items:center; gap:12px; flex-wrap:wrap}
    .badge{background:linear-gradient(135deg,var(--hot),var(--pink)); color:#fff; padding:8px 14px; border-radius:999px; font-weight:700; letter-spacing:.5px; box-shadow:0 10px 20px rgba(255,71,126,.25)}
    h1{margin:8px 0 0; font-size:clamp(28px,4vw,42px)}
    .grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(240px,1fr)); gap:18px; margin-top:24px}
    .card{background:var(--card); border-radius:20px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,.06); position:relative}
    .card h3{margin:0 0 10px; font-size:18px}
    .big{font-size:clamp(18px,2.2vw,22px)}
    button{cursor:pointer; border:0; border-radius:14px; padding:10px 14px; font-weight:700; background:linear-gradient(135deg,var(--lav),var(--pink)); color:#fff; box-shadow:0 8px 20px rgba(167,139,250,.35); transition:transform .05s ease}
    button:active{transform:translateY(1px)}
    .muted{opacity:.75; font-size:13px}
    .pill{display:inline-block; padding:6px 10px; background:#00000008; border-radius:999px; font-size:12px}
    .flex{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
    .center{text-align:center}
    .coupon{display:inline-block; border:2px dashed #ff86af; background:#fff0f6; padding:12px 16px; border-radius:16px; font-weight:700}
    .gallery{display:grid; grid-template-columns:repeat(3, 1fr); gap:8px}
    .gallery img{width:100%; height:110px; object-fit:cover; border-radius:12px}
    .count{font-size:28px; font-weight:900}
    .footer{margin:24px 0; text-align:center; opacity:.7}
    .input{padding:10px 12px; border-radius:12px; border:1px solid #eee; width:100%;}
  </style>
</head>
<body>
  <audio id="bgm" loop>
    <source src="bgm.mp3" type="audio/mpeg">
  </audio>
  <div class="hearts" id="hearts"></div>
  <canvas id="confetti" style="position:fixed; inset:0; pointer-events:none; z-index:2"></canvas>

  <div class="wrap">
    <div class="title">
      <span class="badge">for <span id="herName"></span> ğŸ’˜</span>
      <h1>Hi <span id="herName2"></span>ï¼Œè¿™æ˜¯ä¸€ä»½<span class="pill">ä¸‡ä¸‡é™å®š</span>çš„ä¸“å±å¿«ä¹åŒ…</h1>
    </div>

    <div class="grid">
      <!-- å½©è™¹å± -->
      <section class="card">
        <h3>ä»Šæ—¥å½©è™¹å± ğŸŒˆ</h3>
        <p id="compliment" class="big">ç‚¹ä¸‹é¢æŒ‰é’®ï¼Œè®©æˆ‘è¯´ç‚¹è‚‰éº»çš„ï½</p>
        <div class="flex">
          <button onclick="sayNice()">å¤¸  æˆ‘</button>
          <span class="muted">ï¼ˆæ”¯æŒå¤šæ¬¡ç‚¹å‡»ï¼Œç›´åˆ°ä½ ç¬‘å‡ºå£°ï¼‰</span>
        </div>
      </section>

      <!-- çˆ±çš„åˆ¸ -->
      <section class="card center">
        <h3>æŠ½ä¸€å¼ çˆ±çš„åˆ¸ ğŸŸï¸</h3>
        <div id="coupon" class="coupon">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æŠ½å–</div>
        <div style="margin-top:12px"><button onclick="drawCoupon()">æˆ‘ è¦ è¿™ å¼ </button></div>
        <p class="muted">ä½¿ç”¨æ–¹æ³•ï¼šå‡ºç¤ºæ­¤åˆ¸ï¼Œæˆ‘å¿…é¡»æ— æ¡ä»¶å…‘ç°ã€‚</p>
      </section>

      <!-- å€’è®¡æ—¶ -->
      <section class="card">
      <h3>åœ¨ä¸€èµ·æ—¶é—´ ğŸ’–</h3>
      <p class="muted">æˆ‘ä»¬ä» <span id="anniversaryDisplay"></span> å¼€å§‹åœ¨ä¸€èµ·ï¼š</p>
      <div class="count"><span id="togetherTime"></span></div>
      </section>
      <!-- å°æµ‹éªŒ -->
      <section class="card">
        <h3>æˆ‘æœ‰å¤šäº†è§£ä½  â“</h3>
        <div id="quiz"></div>
        <div style="margin-top:8px" class="flex">
          <button onclick="checkQuiz()">æäº¤ç­”æ¡ˆ</button>
          <span id="quizMsg" class="muted"></span>
        </div>
      </section>

      <!-- å›å¿†ç›¸å†Œ -->
      <section class="card">
        <h3>å›å¿†ç›¸å†Œ ğŸ“¸</h3> 
        <div class="gallery" id="gallery"></div>
        <p class="muted">ç‚¹å›¾ç‰‡å¯æ”¾å¤§æŸ¥çœ‹ï¼ˆæ‰‹æœºä¸Šé•¿æŒ‰ä¿å­˜ï¼‰ã€‚</p>
      </section>

      <!-- ç•™è¨€ -->
      <section class="card">
        <h3>ç»™ä½ çš„æ‚„æ‚„è¯ âœï¸</h3>
        <textarea class="input" id="note" rows="4" placeholder="åœ¨è¿™é‡Œå†™ä¸‹ä»Šå¤©æƒ³å¯¹ä½ è¯´çš„è¯â€¦â€¦"></textarea>
        <div style="margin-top:8px" class="flex">
          <button onclick="saveNote()">ä¿å­˜</button>
          <span id="noteMsg" class="muted"></span>
        </div>
      </section>

      <!-- å°å½©è›‹è¯´æ˜ -->
      <section class="card">
        <h3>éšè—å½©è›‹ ğŸ¥š</h3>
        <p class="big">åœ¨é¡µé¢ä»»æ„å¤„è¾“å…¥ <b>520</b> æœ‰æƒŠå–œï¼›æ‘‡ä¸€æ‘‡ï¼ˆæˆ–å¿«é€ŸåŒå‡»ï¼‰ä¼šæœ‰å½©å¸¦ğŸ‰ã€‚</p>
        <p class="muted">ï¼ˆå¦‚æœæ‰‹æœºæ²¡å¼€é™€èºä»ªæƒé™ï¼Œå°±ç”¨åŒå‡»å§ï¼‰</p>
      </section>
    </div>

    <div class="footer">Made with â¤ï¸ by <span id="yourName"></span></div>
  </div>
</body>

<script>
  // è®¾ç½®åœ¨ä¸€èµ·çš„å¼€å§‹æ—¶é—´ï¼ˆæ ¼å¼ YYYY, M-1, D, H, M, Sï¼‰
const startDate = new Date(2025, 7, 22, 1, 16, 0); // ä¸¾ä¾‹ï¼š2023å¹´1æœˆ1æ—¥12:00:00

function updateTogetherTime() {
  const now = new Date();
  let diff = Math.floor((now - startDate) / 1000); // æ€»ç§’æ•°
  const days = Math.floor(diff / (24*3600));
  diff %= 24*3600;
  const hours = Math.floor(diff / 3600);
  diff %= 3600;
  const minutes = Math.floor(diff / 60);
  const seconds = diff % 60;

  const str = `${days}å¤© ${hours}å°æ—¶ ${minutes}åˆ†é’Ÿ ${seconds}ç§’`;
  document.getElementById('togetherTime').textContent = str;
}

// æ¯ç§’åˆ·æ–°
setInterval(updateTogetherTime, 1000);
updateTogetherTime();

// ====== å¯è‡ªå®šä¹‰åŒºåŸŸï¼ˆæ”¹è¿™é‡Œå°±èƒ½ç§äººå®šåˆ¶ï¼‰ ======
const CONFIG = {
  herName: 'è²å®å®',           // å¥³å‹æ˜µç§°
  yourName: 'ä¸‡ä¸‡',          // ä½ çš„æ˜µç§°
  anniversary: '2025-08-22', // çºªå¿µæ—¥ï¼ˆYYYY-MM-DDï¼‰
  compliments: [
    'ä»Šå¤©çš„è²è²ï¼Œåˆæ¯”æ˜¨å¤©ä¼˜ç§€äº†',
    'è²è²çš„ç¬‘åƒå°å¤ªé˜³ï¼Œç…§åˆ°æˆ‘å¿ƒé‡Œäº†',
    'æƒ³æŠŠå…¨ä¸–ç•Œçš„å¥½å¿ƒæƒ…æ‰“åŒ…å¯„ç»™ä½ ï¼ˆæ”¶ä»¶äººï¼šè²è²ï¼‰',
    'æˆ‘æœ€è¿‘åœ¨å‡è‚¥ï¼Œå‡å»æ²¡æœ‰è²è²çš„æ—¶é—´',
    'è²è²ä¸€å‡ºç°ï¼Œæˆ‘çš„å¤§è„‘å°±è¢« Ctrl+Sï¼šä¿å­˜åˆ°å¿ƒé‡Œ',
    'å–œæ¬¢è¢«è²è²æ‹¿æçš„æ„Ÿè§‰ï¼Œè½»ä¸€ç‚¹ä¹Ÿä¸è¡Œ',
    'æ‰€æœ‰å†™ä¸å‡ºæ¥çš„ Bugï¼Œéƒ½è¢«è²è²çš„å¯çˆ±æ²»å¥½äº†',
    'è²è²çš„çœ¼ç›é‡Œæœ‰æ˜Ÿæ˜Ÿï¼Œè¿˜æœ‰æˆ‘',
    'ç»™è²è²ä¸€ä¸ªå°å¿ƒå¿ƒ â¤ï¼ˆä¸è¦å«Œå°ï¼Œå› ä¸ºæˆ‘çš„æ•´é¢—éƒ½ç»™ä½ äº†ï¼‰',
    'è²è²è¦å¼€å¿ƒï¼Œå¼€å¿ƒæ‰èƒ½é•¿å‘½ç™¾å²',
  ],
  coupons: [
    'æœ¬å‘¨å®¶åŠ¡æˆ‘å…¨åŒ…',
    'ç”µå½±ç”±ä½ é€‰ï¼Œæˆ‘è´Ÿè´£çˆ†ç±³èŠ±',
    'ä¸é™æ—¶è‚©é¢ˆæŒ‰æ‘©æœåŠ¡ä¸€æ¬¡',
    'ä¸€æ—¥ä¸‰é¤å…¨ç¨‹å¤–å–éšä½ ç‚¹',
    'é™ªé€›è¡—åˆ°è…¿è½¯ä¸å–Šç´¯',
    'ç¡å‰æ•…äº‹ + æ—©å®‰å«é†’æœåŠ¡',
    'è¯´å‡ å¥çœŸå¿ƒè¯ï¼ˆæˆ‘ä¿è¯ä¸çš®ï¼‰',
    'æ— æ¡ä»¶æŠ±æŠ±åˆ¸ Ã— æ— é™ç»­æ¯',
    'å°æ—…è¡Œè®¡åˆ’æˆ‘æ¥åšï¼ˆåƒä½è¡Œå…¨åŒ…ï¼‰',
    'ä½ è¯´äº†ç®—çš„ä¸€å¤©'
  ],
  quiz: [
    { q: 'å¥¹æœ€çˆ±çš„å¥¶èŒ¶å“ç‰Œï¼Ÿ', a: 'éœ¸ç‹èŒ¶å§¬' },
    { q: 'å¥¹æœ€æƒ³å»çš„åŸå¸‚ï¼Ÿ', a: 'å†…è’™å¤' },
    { q: 'å¥¹æœ€å–œæ¬¢çš„è”¬èœï¼Ÿ', a: 'ç©ºå¿ƒèœæ¢—' },
  ],
  gallery: [
    'images/1.JPG',
    'images/2.JPG',
    'images/3.JPG'
  ]
};
// ====== è‡ªå®šä¹‰åŒºç»“æŸ ======
// èƒŒæ™¯éŸ³ä¹æ’­æ”¾é€»è¾‘
let bgmPlayed = false;
function playBGM() {
if (bgmPlayed) return;
const bgm = document.getElementById('bgm');
bgm.play().catch(()=>{});
bgmPlayed = true;
}


// ç¬¬ä¸€æ¬¡ç‚¹å‡»é¡µé¢ä»»æ„åœ°æ–¹æ—¶æ’­æ”¾ BGM
window.addEventListener('click', function autoPlayOnce(){
playBGM();
window.removeEventListener('click', autoPlayOnce);
});
// åˆå§‹åŒ–æ–‡æ¡ˆ
const $ = s => document.querySelector(s);
$('#herName').textContent = CONFIG.herName;
$('#herName2').textContent = CONFIG.herName;
$('#yourName').textContent = CONFIG.yourName;

// å€’è®¡æ—¶
function updateDays(){
  const now = new Date();
  const target = new Date(CONFIG.anniversary + 'T00:00:00');
  const diff = Math.ceil((target - now) / (1000*60*60*24));
  $('#days').textContent = diff >= 0 ? diff : Math.abs(diff) + 'ï¼ˆå·²è¿‡ï¼‰';
}
setInterval(updateDays, 60*1000);

// å½©è™¹å±
function sayNice(){
  const t = CONFIG.compliments[Math.floor(Math.random()*CONFIG.compliments.length)];
  $('#compliment').textContent = t;
  confettiBurst();
}

// çˆ±çš„åˆ¸
function drawCoupon(){
  const t = CONFIG.coupons[Math.floor(Math.random()*CONFIG.coupons.length)];
  $('#coupon').textContent = t;
  confettiBurst();
}

// å°æµ‹éªŒ
const quizBox = $('#quiz');
quizBox.innerHTML = CONFIG.quiz.map((it, idx)=>`
  <div style="margin:8px 0">
    <div class="muted">Q${idx+1}ï¼š${it.q}</div>
    <input class="input" id="q${idx}" placeholder="ä½ çš„ç­”æ¡ˆï¼ˆç®€ä½“ä¸­æ–‡æˆ–å…³é”®å­—å³å¯ï¼‰" />
  </div>
`).join('');

function normalize(s){ return (s||'').toString().trim().toLowerCase().replace(/\s+/g,''); }
function checkQuiz(){
  let correct = 0;
  CONFIG.quiz.forEach((it,idx)=>{
    const v = normalize($('#q'+idx).value);
    if(v && normalize(it.a).includes(v)) correct++;
  });
  const msg = `ç­”å¯¹ ${correct}/${CONFIG.quiz.length} é¢˜ã€‚` + (correct===CONFIG.quiz.length ? ' ä½ æœ€æ‡‚æˆ‘å•¦ï¼' : ' å†åŠªåŠ›ä¸€ä¸‹ä¸‹ï½');
  $('#quizMsg').textContent = msg;
  confettiBurst(correct/CONFIG.quiz.length);
}


// ç›¸å†Œ
const gal = $('#gallery');
CONFIG.gallery.forEach(src=>{
  const img = new Image(); img.src = src; img.alt = 'memory';
  img.onclick = ()=> window.open(src,'_blank');
  gal.appendChild(img);
});

// ä¾¿ç­¾
(function loadNote(){
  const key = 'note_'+CONFIG.herName;
  const val = localStorage.getItem(key);
  if(val) $('#note').value = val;
})();
function saveNote(){
  const key = 'note_'+CONFIG.herName;
  localStorage.setItem(key, $('#note').value || '');
  $('#noteMsg').textContent = 'å·²ä¿å­˜ï¼ˆåªä¿å­˜åœ¨ä½ çš„è®¾å¤‡ï¼‰';
  setTimeout(()=> $('#noteMsg').textContent='', 2000);
}

// é£˜å¿ƒå¿ƒ
(function hearts(){
  const wrap = $('#hearts');
  const colors = ['#ff8fab','#ffb3c6','#ffc2d1','#cdb4db','#bde0fe','#a9def9'];
  for(let i=0;i<40;i++){
    const h = document.createElement('div');
    h.className='heart';
    h.style.left = Math.random()*100 + 'vw';
    h.style.animationDuration = (6 + Math.random()*6) + 's';
    h.style.animationDelay = (-Math.random()*6) + 's';
    h.style.color = colors[i%colors.length];
    wrap.appendChild(h);
  }
})();

document.getElementById('anniversaryDisplay').textContent = CONFIG.anniversary;

// ç²‰è‰²å¿ƒå¿ƒç‰¹æ•ˆ
const canvas = document.getElementById('confetti');
const ctx = canvas.getContext('2d');
let parts = [];
function resize(){ canvas.width = innerWidth; canvas.height = innerHeight }
window.addEventListener('resize', resize); resize();


function confettiBurst(scale=1){
const n = Math.floor(50 * (0.4 + scale));
for(let i=0;i<n;i++){
parts.push({
x: innerWidth/2,
y: innerHeight/3,
vx: (Math.random()-0.5)*6,
vy: Math.random()*-8-2,
size: 8 + Math.random()*6,
a: 1,
color: `hsl(${330 + Math.random()*20}, 80%, 70%)`
});
}
}

function drawHeart(ctx, x, y, size, color){
ctx.save();
ctx.translate(x, y);
ctx.scale(size/20, size/20);
ctx.beginPath();
ctx.moveTo(0, -10);
ctx.bezierCurveTo(5, -15, 15, -5, 0, 10);
ctx.bezierCurveTo(-15, -5, -5, -15, 0, -10);
ctx.closePath();
ctx.fillStyle = color;
ctx.fill();
ctx.restore();
}


function tick(){
ctx.clearRect(0,0,canvas.width, canvas.height);
parts.forEach(p=>{
p.vy += 0.15;
p.x += p.vx;
p.y += p.vy;
p.a -= 0.01;
ctx.globalAlpha = Math.max(p.a,0);
drawHeart(ctx, p.x, p.y, p.size, p.color);
});
parts = parts.filter(p=>p.a>0 && p.y<innerHeight+20);
requestAnimationFrame(tick);
}
requestAnimationFrame(tick);

// æ‘‡ä¸€æ‘‡ or åŒå‡»
let lastTap=0;
window.addEventListener('devicemotion', (e)=>{
  const a = e.accelerationIncludingGravity;
  if(!a) return;
  const mag = Math.abs(a.x)+Math.abs(a.y)+Math.abs(a.z);
  if(mag>40) confettiBurst();
});
window.addEventListener('dblclick', ()=> confettiBurst());

// å½©è›‹ï¼šè¾“å…¥ 520
let code='';
window.addEventListener('keydown', (e)=>{
  code += e.key; if(code.length>10) code = code.slice(-10);
  if(code.includes('520')){ confettiBurst(1.2); code=''; }
});
</script>
</html>
